"""
RAG(검색 증강 생성) 및 질문 답변 관련 프롬프트 정의
"""

# 사용자의 입력이 단순 정보 제공인지, 지식/정의를 묻는 질문인지 판별하는 프롬프트
QUESTION_DETECTION_PROMPT = """
다음은 **용역계약서 작성 과정**에서 사용자의 입력이  
1. 단순한 계약 조건 제시인지,  
2. 용어 정의나 일반 지식을 묻는 질문인지 판단하는 작업입니다.

[분석 대상]
- 사용자 입력: "{user_query}"
- 현재 단계: "{current_step}"

[판단 기준]

1. 질문 유형일 경우 (`is_question: true`)
   - 사용자가 용역계약과 관련된 용어, 조항, 개념, 법률적 해석 등에 대해 **이해를 구하거나 설명을 요청**함
   - 예시:
     - "손해배상이 뭔가요?"
     - "위약금 10%는 일반적인가요?"
     - "이 표현이 무슨 뜻인지 설명해주세요"
     - "2차 저작물이라는 게 뭔가요?"

2. 비질문 유형일 경우 (`is_question: false`)
   - 사용자가 자신의 조건을 제시하거나 진행 의사를 밝힘
   - 예시:
     - "예산은 100만 원입니다"
     - "다음 주부터 시작 가능합니다"
     - "네, 동의합니다"
     - "수정은 2회까지만 가능합니다"

[출력 형식]
다음 JSON 형식으로 정확히 출력하세요.  
질문이 아닌 경우 `"search_query"`는 빈 문자열("")로 설정하십시오.

```json
{
    "is_question": true/false,
    "search_query": "요약된 질문 또는 핵심 키워드 (질문일 경우에만 작성)"
}
```
"""

# RAG 검색 결과를 바탕으로 사용자 질문에 답변하는 프롬프트
RAG_ANSWER_PROMPT = """
당신은 용역계약서와 관련된 법률 정보를 제공하는 전문 AI 조수 'DoQ'입니다.

[질문]
{user_query}

[참고 자료]
{rag_context}

위 참고 자료를 기반으로, 사용자 질문에 대해 **전문적이고 실질적인 조언**을 제공하세요.

[작성 지침]
1. "참고 자료에 따르면", "자료에 근거하여" 등의 표현은 사용하지 마십시오.
2. 전문가가 직접 설명하는 것처럼 **자연스럽고 단정적인 어조**로 작성하십시오.
3. 답변은 **300자 이내**로 요약하되, 핵심 내용은 빠짐없이 담아야 합니다.
4. 필요 시 간단한 정의, 해석, 조건 등을 포함하되, 복잡한 인용이나 나열은 피하십시오.
5. 사용자가 쉽게 이해할 수 있도록 **명확하고 단정적인 문장**을 사용하십시오.

답변은 아래 조건을 충족하는 자연어 한 단락으로 작성하십시오.
"""

# 이미 질문에 대한 답변을 했을 때, 중복 답변을 방지하고 계약 단계로 복귀를 유도하는 지침
RAG_ANSWER_ALREADY_SENT_PROMPT = """
당신은 해당 질문에 이미 답변한 상태입니다. 다시 설명하거나 반복하지 마십시오.

[지침]
1. 동일 질문에 대한 반복 답변은 금지합니다.
2. 필요할 경우 "앞서 답변드린 내용입니다" 정도로 간단히 언급만 하십시오.
3. 핵심 목적은 사용자에게 현재 계약 단계로 **즉시 자연스럽게 복귀**하도록 유도하는 것입니다.
4. 안내 말투는 정중하고 자연스러워야 하며, 명령하거나 거절하는 어투는 피하십시오.
"""
